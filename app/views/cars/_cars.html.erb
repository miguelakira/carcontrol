<div data-pjax-container>
    <div id = "sidebar">
    <% if @car %>
         
         <dl>
            <h3><%= @car.placa %></h3>

            <dt>Localização Atual:</dt>
            <dd><% unless @car.localizacao.nil? %><%= @car.localizacao %><% end -%> 
            </dd>

            <dt>Cidade de Origem:</dt>
            <dd><% unless @car.cidade_origem.nil? %><%= Cidade.find(@car.cidade_origem).text %>, <%= Estado.find(@car.estado_origem).sigla %><% end -%> 
            </dd>
            <dt>Cidade de Destino:</dt>
            <dd><% unless @car.cidade_destino.nil? %><%= Cidade.find(@car.cidade_destino).text %>, <%= Estado.find(@car.estado_destino).sigla %><% end -%></dd>

            <dt>Previsão de Entrega:</dt>
            <dd><%= @car.data_prevista.strftime("%d/%m/%Y") unless @car.data_prevista.nil? %></dd>

            <p class="acoes">
                <%= link_to "Detalhes", @car %> |
                <%= link_to "Editar", edit_car_path(@car) %> |
                <%= link_to "Deletar", @car, method: :delete, confirm: "Are you sure?" %>
            </p>
        </dl>
    <% end -%>
</div>
</div>



<table style = "width:1030px" id="mytable" cellspacing="0" summary="Lista de Vendas">  
    <tr>
        <!-- usar < % = sortable 'modelo' % > caso queira deixar sortable -->
        <th width = '10' class = 'none'>Nº</th>
        <th width = '30'class = 'begin'><%= sortable 'data_compra' %></th>
        <th width = '180'><%= sortable 'localizacao', "Localização Atual" %></th>
        
        <th width = '150'> <%= sortable 'nome', 'Cliente' %> </th>
        <th width = '70'> <%= sortable 'modelo' %> </th> 
        <th width = '100'> <%= sortable 'placa' %> </th> 
        <th width = '100'> <%= sortable 'ativo', 'Status' %> </th>
        <th width = "40px"><%= sortable "status_pagamento", "Status do Pagamento" %></th>
        
        <th width = '100'> <%= sortable 'saldo_total' %> </th>
        <th width = '100'> <%= sortable 'saldo_devedor' %> </th>
        <th width = '80'> <%= sortable "cegonha" %> </th>
        <th width = '80'> <%= sortable "parceiro" %> </th>
        
        
  </tr>

<% x = 0%>


<% @cars.each_with_index do |car, index| %>
<% if car.status_pagamento.value == 1  
        @row_class = 'nao-pago' 
    elsif car.status_pagamento.value == 2
        @row_class = 'pendente' 
    else
        @row_class = ''; 
    end %>

  <tr>

    <td class = "<%= @row_class %> none"> <%= index + 1 %>. </td>
    <td class = "<%= @row_class %> begin "><%= car.data_compra.strftime("%d/%m") %></td>

    <td class = "<%= @row_class %>"><% unless car.localizacao.nil? %><%= car.localizacao %> <% if car.ativo? %><%= link_to image_tag("edit_local.png", :border=>0, :title => "Editar Localização"), edit_car_path(car, :editar_localizacao => true, :car => car.id), :class => 'right'  %><% end -%> <% end -%></td>
    <td class = "<%= @row_class %>"> <%= car.comprador ? car.comprador.nome : car.empresa.nome %></td>
    <td class = "<%= @row_class %>"><%= car.modelo.titleize %></td>
    <td class = "<%= @row_class %>"><%= link_to car.placa, :car_id => car.id %><%= link_to image_tag("edit_local.png", :border=>0), edit_car_path(car, :car => car.id), :class => 'right'  %> </td>
    <td class = "<%= @row_class %>"><%= StatusVeiculo::estados[car.ativo] %></td>
    
    <td class = "<%= @row_class %>"><%= car.status_pagamento.status %></td>
    
    <td class = "<%= @row_class %>"><%= retorna_valor_monetario(car.pagamento.valor_total) %> 
    </td>
    <td class = "<%= @row_class %>"><%= retorna_valor_monetario(car.pagamento.saldo_devedor) %></td>
    <td class = "<%= @row_class %>"><%= car.cegonha ? link_to(car.cegonha.placa, car.cegonha) : "" %></td>
    <td class = "<%= @row_class %>"><%= car.parceiro ? link_to(car.parceiro.nome, car.parceiro) : "" %></td>
    <!--<td class = "<%#= @row_class %>"><%#= car.comprador ? car.comprador.telefone : car.empresa.telefone %></td> -->
    
    
  </tr>
<% end %>
</table>

